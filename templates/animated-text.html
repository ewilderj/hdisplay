<style>
  .wrap { width:100%; height:100%; display:flex; align-items:center; justify-content:center; background:#000; overflow:hidden; }
  .marquee { color:#fff; font-size:64px; font-weight:700; white-space:nowrap; will-change: transform; animation: scroll var(--duration, 12s) linear infinite; }
  @keyframes scroll { from { transform: translateX(var(--start, 100%)); } to { transform: translateX(var(--end, -100%)); } }
</style>
<div class="wrap">
  <div class="marquee">{{ text }}</div>
</div>
<script>
(function(){
  // velocity: pixels per second (intuitive: higher = faster). Optional legacy 'speed' in seconds per loop.
  const velocityRaw = String.raw`{{ velocity }}`;
  const speedRaw = String.raw`{{ speed }}`; // legacy
  const velocity = Number(velocityRaw) || 80; // px/s default
  const fixedDuration = Number(speedRaw);

  const wrap = document.querySelector('.wrap');
  const el = document.querySelector('.marquee');

  function setup(){
    // Measure widths
    const cw = wrap.clientWidth || 1280;
    const tw = el.scrollWidth || 1000;
    // Distance to travel: from just outside right edge to just outside left
    const distance = cw + tw;
    const durationSec = Number.isFinite(fixedDuration) && fixedDuration > 0 ? fixedDuration : Math.max(0.1, distance / Math.max(10, velocity));
    el.style.setProperty('--start', cw + 'px');
    el.style.setProperty('--end', (-tw) + 'px');
    el.style.setProperty('--duration', durationSec + 's');
  }
  window.addEventListener('load', setup);
  window.addEventListener('resize', setup);
  // If fonts load later, remeasure
  setTimeout(setup, 50);
})();
</script>
